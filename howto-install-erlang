#-*- mode: org; mode:visual-line; mode:org-indent -*-
#+TITLE: Эрланг суулгах заавар
#+AUTHOR: nagi
#+STARTUP: indent
#+STARTUP: hidestars

* Санал болгосон суулгах арга барил
  Дараах сангийн зохицуулалтаар суулгавал зохилтой.
  current гэдэг нь releases дотор байгаа хамгийн сүүлийн үеийн хувилбар луу software холбоос хийсэн байвал зохино.

#+begin_src
  ~/erlang
    -- current -> releases/R14A
    -- releases
       -- R13B01
       -- R14A
    -- site
       -- mochiweb-0.5
       -- ...
    -- setup.sh
#+end_src

    setup.sh файлыг системийнхээ ачаалагддаг бүрхүүлд зааж өгөх хэрэгтэй.
    Жишээ нь ~/.bash_profile дотроо ". ~/erlang/setup.sh" гэж оруулах (урдаа цэгэн тушаал буйг анзаарна уу).
    setup.sh дараах хэлбэртэй файл байхад болно:

#+begin_src
#!/bin/sh

SHELLVAR=`$SHELL -c 'echo $0' | xargs basename`

case $SHELLVAR in
    bash)
        export ERL_ROOT=$HOME/erlang/current
        export ERL_LIBS=$HOME/erlang/site
        export MANPATH=$ERL_ROOT/man:$MANPATH
        export PATH=$ERL_ROOT/bin:$PATH
        ;;
    tcsh|csh)
        setenv ERL_ROOT $HOME/erlang/current
        setenv ERL_LIBS $HOME/erlang/site
        setenv MANPATH $ERL_ROOT/man:$MANPATH
        set path=($path $ERL_ROOT/bin)
        ;;
    *)
        ;;
esac

#+end_src

* Суулгахаас өмнө
  үбүнтү машин дээр дараах багцууд суусан байх хэрэгтэй (sudo apt-get install ....):
  build-essential
  libncurses-dev
  m4
  libssl-dev
  subversion
  autoconf
  automake
  libgd-dev

  xsltproc
  fop

* Татаж авах
http://www.erlang.org/download.html хаягаас хамгийн сүүлийн хувилбараас source гэсэн баганад буй эх кодыг нь татаж авна. ( otp_src_RXXXXX.tar.gz )

* Задлах
#+begin_src
tar xvfz otp_src_R1XXX.tar.gz
#+end_src

* Тохируулах

cd otp_src_R1XXX
#+begin_src
Стандарт сан дотор суулгахаар бол ( /usr/local/{bin,lib/erlang,man/man1} гэсэн сангуудад файлууд хуулагдана )
./configure

хэрэв өөрийн тусгай санд суулгахаар бол ( жишээ нь санал болгосон хэлбэрээр суулгахаар бол )
./configure --prefix=~/erlang/releases/R1XXX

хэрэв олон процесортой бол
./configure --enable-smp-support
#+end_src

* Хөрвүүлэх болон суулгах
#+begin_src
make
#+end_src

хөрвөж дууссаны дараа суулгахдаа
#+begin_src
make install   ( хэрэв стандарт санд дотор суулгах гэж байгаа бол рүүт эрхээр гүйцэтгэх хэрэгтэй байж магадгүй )
#+end_src

* Бичиг баримтуудыг нь суулгах
Татаж авах хаягнаас html, man pages гэсэн хоёр баганаас тус бүрд нь татаж авна. ( otp_doc_html_XXXX.tar.gz otp_doc_man_XXXX.tar.gz )

* Задлах

хэрэв стандарт сан дотор суулгасан бол: ( рүүт эрх шаардлагатай )
#+begin_src
tar xvfz opt_doc_html_XXXX.tar.gz -C /usr/local/lib/erlang/
#+end_src

Хэрэв өөрийн гэсэн санд суулгасан бол: ( дээрх жишээний санг авч үзье )
#+begin_src
tar xvfz opt_doc_html_XXXX.tar.gz -C /opt/myerlang/lib/erlang
#+end_src

* Суулгаснаа шалгах
#+begin_src
erl --version
#+end_src

* Бичиг баримт суусныг шалгах
#+begin_src
erl -man os
#+end_src

* Бичиг баримтын man хуудаснуудыг системийн man дотор оруулах
.tcshrc файл дотроо:
#+begin_src
set MANPATH=`manpath`
set MANPATH="${MANPATH}:/usr/local/lib/erlang/man"
#+end_src

.bashrc хэрэглэдэг бол:
#+begin_src
MANPATH=`manpath`
MANPATH="${MANPATH}:/usr/local/lib/erlang/man"
export MANPATH
#+end_src

* Өөр нэмэлт багц суулгах
~/.erlang  файл дотор байгаа тушаалыг эрланг эхлэх үедээ гүйцэтгэдэг. Тийм болохоор шинээр суулгая гэсэн багцаа дараах маягаар суулгаж болно:
#+begin_src
io:format("Adding libs in HOME/.erlang\n", []).
code:add_path("/home/nagi/myerl_libs/ibrowse-1.6.1/ebin").
io:format(".erlang rc finished\n", []).
#+end_src
